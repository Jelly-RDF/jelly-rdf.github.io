
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Jelly is a high-performance RDF streaming protocol">
      
      
      
        <link rel="canonical" href="https://jelly-rdf.github.io/dev/specification/serialization/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../streaming/">
      
      
      <link rel="icon" href="../../assets/jelly_color.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Serialization format - Jelly</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
    
    
        
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Jelly – Serialization format" />
    <meta property="og:description" content="Jelly is a high-performance RDF streaming protocol" />
    <meta property="og:image" content="https://w3id.org/jelly/dev/assets/social.png" />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta name="google-site-verification" content="JMy5zT6f11aw--RbVdmvGDEfHi_khf67nj7XDkz0KvA" />

   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#jelly-serialization-format-specification" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Jelly" class="md-header__button md-logo" aria-label="Jelly" data-md-component="logo">
      
  <img src="../../assets/jelly_white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jelly
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Serialization format
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.04 7 9.54s-2.94 8.27-7 9.54c.95.3 1.95.46 3 .46a10 10 0 0 0 10-10A10 10 0 0 0 9 2"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <!--
  Adapted from: https://github.com/squidfunk/mkdocs-material/blob/ab1511074c6eb03063b9258e8e42a117a57f5853/src/templates/partials/source.html

  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Repository information -->
<a
  href="https://github.com/Jelly-RDF/jelly-protobuf"
  title="Go to repository"
  class="md-source"
  data-md-component="source"
>
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Jelly-RDF/jelly-protobuf
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Jelly" class="md-nav__button md-logo" aria-label="Jelly" data-md-component="logo">
      
  <img src="../../assets/jelly_white.png" alt="logo">

    </a>
    Jelly
  </label>
  
    <div class="md-nav__source">
      <!--
  Adapted from: https://github.com/squidfunk/mkdocs-material/blob/ab1511074c6eb03063b9258e8e42a117a57f5853/src/templates/partials/source.html

  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Repository information -->
<a
  href="https://github.com/Jelly-RDF/jelly-protobuf"
  title="Go to repository"
  class="md-source"
  data-md-component="source"
>
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Jelly-RDF/jelly-protobuf
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../performance/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Performance
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Performance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../performance/rdf4j/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RDF4J benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Protocol specification
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Protocol specification
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Serialization format
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Serialization format
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#conformance" class="md-nav__link">
    <span class="md-ellipsis">
      Conformance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#versioning" class="md-nav__link">
    <span class="md-ellipsis">
      Versioning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Versioning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backward-compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      Backward compatibility
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forward-compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      Forward compatibility
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actors-and-implementations" class="md-nav__link">
    <span class="md-ellipsis">
      Actors and implementations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#format-specification" class="md-nav__link">
    <span class="md-ellipsis">
      Format specification
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Format specification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stream-frames" class="md-nav__link">
    <span class="md-ellipsis">
      Stream frames
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stream frames">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ordering" class="md-nav__link">
    <span class="md-ellipsis">
      Ordering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stream-frame-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Stream frame metadata
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stream-rows" class="md-nav__link">
    <span class="md-ellipsis">
      Stream rows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physical-stream-types" class="md-nav__link">
    <span class="md-ellipsis">
      Physical stream types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logical-stream-types" class="md-nav__link">
    <span class="md-ellipsis">
      Logical stream types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Logical stream types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#version-compatibility-and-base-types" class="md-nav__link">
    <span class="md-ellipsis">
      Version compatibility and base types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consistency-with-physical-stream-types" class="md-nav__link">
    <span class="md-ellipsis">
      Consistency with physical stream types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stream-options" class="md-nav__link">
    <span class="md-ellipsis">
      Stream options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefix-name-and-datatype-lookup-entries" class="md-nav__link">
    <span class="md-ellipsis">
      Prefix, name, and datatype lookup entries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdf-statements-and-graphs" class="md-nav__link">
    <span class="md-ellipsis">
      RDF statements and graphs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RDF statements and graphs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#repeated-terms" class="md-nav__link">
    <span class="md-ellipsis">
      Repeated terms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdf-terms-and-graph-nodes" class="md-nav__link">
    <span class="md-ellipsis">
      RDF terms and graph nodes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RDF terms and graph nodes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iris" class="md-nav__link">
    <span class="md-ellipsis">
      IRIs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blank-nodes" class="md-nav__link">
    <span class="md-ellipsis">
      Blank nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#literals" class="md-nav__link">
    <span class="md-ellipsis">
      Literals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quoted-triples-rdf-star" class="md-nav__link">
    <span class="md-ellipsis">
      Quoted triples (RDF-star)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graph-nodes" class="md-nav__link">
    <span class="md-ellipsis">
      Graph nodes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#namespace-declarations" class="md-nav__link">
    <span class="md-ellipsis">
      Namespace declarations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delimited-variant-of-jelly" class="md-nav__link">
    <span class="md-ellipsis">
      Delimited variant of Jelly
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Delimited variant of Jelly">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#delimited-variant-implementations" class="md-nav__link">
    <span class="md-ellipsis">
      Delimited variant implementations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#internet-media-type-and-file-extension" class="md-nav__link">
    <span class="md-ellipsis">
      Internet media type and file extension
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Security considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#protocol-buffers" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Buffers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overly-large-lookup-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Overly large lookup tables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#invalid-lookup-entry-ids-and-references" class="md-nav__link">
    <span class="md-ellipsis">
      Invalid lookup entry IDs and references
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#infinite-recursion-of-rdf-star-quoted-triples" class="md-nav__link">
    <span class="md-ellipsis">
      Infinite recursion of RDF-star quoted triples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdf-content" class="md-nav__link">
    <span class="md-ellipsis">
      RDF content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encryption-authentication-and-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      Encryption, authentication, and authorization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementations" class="md-nav__link">
    <span class="md-ellipsis">
      Implementations
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gRPC streaming protocol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Protobuf reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../protobuf-source/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Protobuf source
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../media-type/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File extensions and media types
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://w3id.org/jelly/jelly-jvm/dev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JVM (Scala) implementation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../use-cases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use cases
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../licensing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Licensing and citation
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#conformance" class="md-nav__link">
    <span class="md-ellipsis">
      Conformance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#versioning" class="md-nav__link">
    <span class="md-ellipsis">
      Versioning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Versioning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backward-compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      Backward compatibility
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forward-compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      Forward compatibility
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actors-and-implementations" class="md-nav__link">
    <span class="md-ellipsis">
      Actors and implementations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#format-specification" class="md-nav__link">
    <span class="md-ellipsis">
      Format specification
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Format specification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stream-frames" class="md-nav__link">
    <span class="md-ellipsis">
      Stream frames
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stream frames">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ordering" class="md-nav__link">
    <span class="md-ellipsis">
      Ordering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stream-frame-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Stream frame metadata
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stream-rows" class="md-nav__link">
    <span class="md-ellipsis">
      Stream rows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physical-stream-types" class="md-nav__link">
    <span class="md-ellipsis">
      Physical stream types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logical-stream-types" class="md-nav__link">
    <span class="md-ellipsis">
      Logical stream types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Logical stream types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#version-compatibility-and-base-types" class="md-nav__link">
    <span class="md-ellipsis">
      Version compatibility and base types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consistency-with-physical-stream-types" class="md-nav__link">
    <span class="md-ellipsis">
      Consistency with physical stream types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stream-options" class="md-nav__link">
    <span class="md-ellipsis">
      Stream options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefix-name-and-datatype-lookup-entries" class="md-nav__link">
    <span class="md-ellipsis">
      Prefix, name, and datatype lookup entries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdf-statements-and-graphs" class="md-nav__link">
    <span class="md-ellipsis">
      RDF statements and graphs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RDF statements and graphs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#repeated-terms" class="md-nav__link">
    <span class="md-ellipsis">
      Repeated terms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdf-terms-and-graph-nodes" class="md-nav__link">
    <span class="md-ellipsis">
      RDF terms and graph nodes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RDF terms and graph nodes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iris" class="md-nav__link">
    <span class="md-ellipsis">
      IRIs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blank-nodes" class="md-nav__link">
    <span class="md-ellipsis">
      Blank nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#literals" class="md-nav__link">
    <span class="md-ellipsis">
      Literals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quoted-triples-rdf-star" class="md-nav__link">
    <span class="md-ellipsis">
      Quoted triples (RDF-star)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graph-nodes" class="md-nav__link">
    <span class="md-ellipsis">
      Graph nodes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#namespace-declarations" class="md-nav__link">
    <span class="md-ellipsis">
      Namespace declarations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delimited-variant-of-jelly" class="md-nav__link">
    <span class="md-ellipsis">
      Delimited variant of Jelly
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Delimited variant of Jelly">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#delimited-variant-implementations" class="md-nav__link">
    <span class="md-ellipsis">
      Delimited variant implementations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#internet-media-type-and-file-extension" class="md-nav__link">
    <span class="md-ellipsis">
      Internet media type and file extension
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Security considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#protocol-buffers" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Buffers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overly-large-lookup-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Overly large lookup tables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#invalid-lookup-entry-ids-and-references" class="md-nav__link">
    <span class="md-ellipsis">
      Invalid lookup entry IDs and references
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#infinite-recursion-of-rdf-star-quoted-triples" class="md-nav__link">
    <span class="md-ellipsis">
      Infinite recursion of RDF-star quoted triples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdf-content" class="md-nav__link">
    <span class="md-ellipsis">
      RDF content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encryption-authentication-and-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      Encryption, authentication, and authorization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementations" class="md-nav__link">
    <span class="md-ellipsis">
      Implementations
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Jelly-RDF/jelly-rdf.github.io/edit/main/docs/specification/serialization.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="jelly-serialization-format-specification">Jelly serialization format specification</h1>
<p><strong>This document is the specification of the Jelly serialization format. It is intended for implementers of Jelly libraries and applications.</strong> If you are looking for a user-friendly introduction to Jelly, see the <a href="../">Jelly index page</a>.</p>
<p>This document is accompanied by the <a href="../reference/">Jelly Protobuf reference</a> and the Protobuf definition itself (<a href="https://github.com/Jelly-RDF/jelly-protobuf/blob/main/proto/rdf.proto"><code>rdf.proto</code></a>).</p>
<p>The following assumptions are used in this document:</p>
<ul>
<li>The basis for the terms used is the RDF 1.1 specification (<a href="https://www.w3.org/TR/2014/REC-rdf11-concepts-20140225/">W3C Recommendation 25 February 2014</a>).</li>
<li>Additionally, the RDF 1.1 Turtle specification (<a href="https://www.w3.org/TR/2014/REC-turtle-20140225/">W3C Recommendation 25 February 2014</a>) is used in parts as a basis for selected definitions.</li>
<li>In parts referring to RDF-star, the RDF-star draft specification (<a href="https://w3c.github.io/rdf-star/cg-spec/editors_draft.html">W3C Community Group Draft Report 29 June 2023</a>) is used. As the scope in which the RDF-star specification is used here is minimal, later versions of the specification are expected to be compatible with this document.</li>
<li>In parts referring to the RDF Stream Taxonomy (RDF-STaX), the <a href="https://w3id.org/stax/1.1.2/ontology">RDF-STaX version 1.1.2 ontology</a> and <a href="https://w3id.org/stax/1.1.2/taxonomy">taxonomy</a> are used.</li>
<li>All strings in the serialization are assumed to be UTF-8 encoded.</li>
</ul>
<table>
<thead>
<tr>
<th>Document information</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Author:</strong></td>
<td><a href="https://ostrzyciel.eu">Piotr Sowiński</a> (<a href="https://github.com/Ostrzyciel">Ostrzyciel</a>)</td>
</tr>
<tr>
<td><strong>Version:</strong></td>
<td>dev</td>
</tr>
<tr>
<td><strong>Date:</strong></td>
<td><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">March 26, 2025</span></td>
</tr>
<tr>
<td><strong>Permanent URL:</strong></td>
<td><a href="https://w3id.org/jelly/dev/specification/serialization"><code>https://w3id.org/jelly/dev/specification/serialization</code></a></td>
</tr>
<tr>
<td><strong>Document status</strong>:</td>
<td>Draft specification</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="https://www.rfc-editor.org/rfc/rfc2119">RFC 2119</a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The "Note" blocks in this document are not part of the specification, but rather provide additional information for implementers.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The "Example" blocks in this document are not part of the specification, but rather provide informal examples of the serialization format.</p>
</div>
<h2 id="conformance">Conformance</h2>
<p>Implementations MAY choose to implement only a subset of the following specification. In this case, they SHOULD clearly specify which parts of the specification they implement. In the rest of this specification, the keywords "MUST", "MUST NOT", etc. refer to full (not partial) implementations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Implementations may in particular choose to not implement features that are not supported on the target platform (e.g., RDF datasets, RDF-star, generalized RDF terms, etc.).</p>
</div>
<p>Implementations MAY also choose to extend Jelly with additional features that SHOULD NOT interfere with the serialization being readable by implementations which follow the specification.</p>
<h2 id="versioning">Versioning</h2>
<p>The protocol follows the <a href="https://semver.org/">Semantic Versioning 2.0</a> scheme. Each MAJOR.MINOR semantic version corresponds to an integer version tag in the protocol. The version tag is encoded in the <code>version</code> field of the <a href="../reference/#rdfstreamoptions"><code>RdfStreamOptions</code></a> message. See also the <a href="#stream-options">section on stream options</a> for more information on how to handle the version tags in serialized streams.</p>
<p>The following versions of the protocol are defined:</p>
<table>
<thead>
<tr>
<th>Version tag</th>
<th>Semantic version</th>
<th>Last release date</th>
<th>Changes</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1.0.x</td>
<td>August 24, 2024</td>
<td>(initial version)</td>
</tr>
<tr>
<td>2</td>
<td>1.1.0</td>
<td>December 21, 2024</td>
<td>Added <a href="#namespace-declarations"><code>RdfNamespaceDeclaration</code></a></td>
</tr>
<tr>
<td>2</td>
<td>1.1.1 <strong>(current)</strong></td>
<td><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">March 26, 2025</span></td>
<td>Added <a href="#stream-frame-metadata"><code>RdfStreamFrame.metadata</code></a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Releases of the protocol are published on <a href="https://github.com/Jelly-RDF/jelly-protobuf/releases">GitHub</a>.</p>
</div>
<h3 id="backward-compatibility">Backward compatibility</h3>
<p>Implementations SHOULD ensure backward compatibility. To achieve backward compatibility, the implementation MUST be able to read all messages from the previous releases of the protocol with the same MAJOR version. The implementation MAY also be able to read messages from previous releases of the protocol with a different MAJOR version.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The protocol is designed in such a way that you don't need to worry about backward compatibility. The only thing you need to do is to implement the latest version of the protocol, and you will automatically get backward compatibility with all previous versions (of the same MAJOR).</p>
</div>
<h3 id="forward-compatibility">Forward compatibility</h3>
<p>Forward compatibility is not guaranteed across different MINOR versions of the protocol. Implementations MAY be able to read messages from future releases of the protocol with the same MAJOR version. Implementations MAY also be able to read messages from future releases of the protocol with a different MAJOR version.</p>
<p>New features introduced in PATCH versions of the protocol MUST NOT break forward compatibility.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In practical terms, new MINOR versions of the protocol usually introduce new types of messages that previous implementations do not know how to handle. As long as the producer does not use the new messages in the stream, consumers implementing the previous protocol version will be able to read the stream.</p>
<p>However, implementations will generally refuse to read a stream that is marked as using a higher protocol version than they support (see: <a href="#stream-options">stream options: <code>version</code> field</a>). If you, as a producer, do not intend to use the new features of the protocol, we recommend you mark the stream with the lowest applicable version (see the version table above for a correspondence between features and versions). This way, older implementations will be able to read the stream.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Forward-compatible features</p>
<p>Protobuf allows for adding new fields to messages without breaking compatibility with older implementations – they will simply ignore the new field. An example of this is the <code>metadata</code> field in the <code>RdfStreamFrame</code> message, which was added in version 1.1.1. Implementations of version 1.1.0 will ignore it.</p>
</div>
<h2 id="actors-and-implementations">Actors and implementations</h2>
<p>Jelly assumes there to be two actors involved in processing the stream: the producer (serializer) and the consumer (parser). The producer is responsible for serializing the RDF data into the Jelly format, and the consumer is responsible for parsing the Jelly format into RDF data.</p>
<p>Implementations may include only the producer, only the consumer, or both.</p>
<h2 id="format-specification">Format specification</h2>
<p>The Jelly serialization format uses <a href="https://protobuf.dev/programming-guides/proto3/">Protocol Buffers version 3</a> as the underlying serialization format. All implementations MUST use a compliant Protocol Buffers implementation. The Protocol Buffers schema for Jelly serialization is defined in <code>rdf.proto</code> (<a href="https://github.com/Jelly-RDF/jelly-protobuf/blob/main/proto/rdf.proto">source code</a>, <a href="../reference/#rdfproto">reference</a>).</p>
<p>The Jelly format is a <em>stream</em> (i.e., an ordered sequence) of <em>stream frames</em>. The frames may be sent one-by-one using a dedicated streaming protocol (e.g., <a href="../streaming/">gRPC</a>, MQTT, Kafka) or written in sequence to a byte stream (e.g., a file or socket). When writing to a byte stream, the frames MUST be delimited – see the <a href="#delimited-variant-of-jelly">delimited variant</a>.</p>
<p>Jelly supports several distinct <a href="#physical-stream-types">physical types of streams</a>, and uses a simple and configurable compression mechanism using <a href="#prefix-name-and-datatype-lookup-entries">lookup tables</a>.</p>
<h3 id="stream-frames">Stream frames</h3>
<p>A stream frame is a message of type <code>RdfStreamFrame</code> (<a href="../reference/#rdfstreamframe">reference</a>). The message has a field <code>rows</code>, which is a repeated field of type <code>RdfStreamRow</code> (<a href="../reference/#rdfstreamrow">reference</a>). A stream frame may contain any number of rows, however it is RECOMMENDED to keep the size of the frames below 1 MB. The semantics for the frames are not defined by the protocol. The end users are free to define their own semantics for the frames.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A stream frame in "simple flat file" is just a batch of RDF statements – the stream frames may carry no semantics in this case. You can make the stream frame as long as the file itself, but this is not recommended, as it would make the file harder to process.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Stream frames can also be used to indicate individual stream elements. For example, in the case of a stream of RDF datasets, each frame may contain one dataset. <a href="https://w3id.org/riverbench/datasets">RiverBench datasets</a> use this convention in their distributions.</p>
</div>
<h4 id="ordering">Ordering</h4>
<p>Stream frames MUST be processed strictly in order to preserve the semantics of the stream. Each stream frame MUST be processed in its entirety before the next stream frame is processed.</p>
<p>Implementations MAY choose to adopt a <strong>non-standard</strong> solution where the order or delivery of the frames is not guaranteed and the stream can be read in more than one order or without some frames. The implementation MUST clearly specify in the documentation that it uses such a non-standard solution.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An example where not adhering to the strict ordering may be useful is when you are dealing with a network streaming protocol that does not guarantee the order of the messages (e.g., MQTT).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The main thing you will need to worry about is the order of the lookup tables. If you can, emit all lookup tables at the beginning of the stream. When using stream partitions (e.g., in Kafka), you should ensure that the lookups are emitted to each partition. Alternatively, you can transmit the lookup tables separately from the stream.</p>
</div>
<h4 id="stream-frame-metadata">Stream frame metadata</h4>
<p>Since protocol version 1.1.1, <code>RdfStreamFrame</code> messages have a <code>metadata</code> field of type <code>map&lt;string, bytes&gt;</code>. This field is OPTIONAL and does not influence the processing of RDF data in any manner. The keys and values in the map are arbitrary and implementation-defined.</p>
<p>Consumers SHOULD ignore unknown keys in the metadata map. Consumers also SHOULD validate the values in the metadata map to ensure that they follow the expected format. Consumers MUST NOT assume that values are character strings or that they are valid UTF-8.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The metadata field is intended for use cases where additional information about the stream frame must be attached directly to the stream, but not as part of the RDF stream itself. For example, you could use it to store the timestamp of the frame, its unique identifier, hash code, or anything else relevant to your use case.</p>
<p>You can use the metadata to store UTF-8 strings, numbers, or even nested protobuf messages. Because of this, you should never assume that the value is a valid string. Always validate the value before using it.</p>
</div>
<h3 id="stream-rows">Stream rows</h3>
<p>A stream row is a message of type <code>RdfStreamRow</code>. It has one of the following fields set:</p>
<ul>
<li><code>options</code> (1) – <a href="#stream-options">stream options header</a>, indicating the compression options and the used RDF features in the stream.</li>
<li><code>triple</code> (2) – <a href="#rdf-statements-and-graphs">RDF triple statement</a>. It MUST NOT appear in streams of type other than <code>PHYSICAL_STREAM_TYPE_TRIPLES</code> or <code>PHYSICAL_STREAM_TYPE_GRAPHS</code>.</li>
<li><code>quad</code> (3) – <a href="#rdf-statements-and-graphs">RDF quad statement</a>. It MUST NOT appear in streams of type other than <code>PHYSICAL_STREAM_TYPE_QUADS</code>.</li>
<li><code>graph_start</code> (4) – indicates the <a href="#rdf-statements-and-graphs">start of a graph</a> (named or default). It MUST NOT appear in streams of type other than <code>PHYSICAL_STREAM_TYPE_GRAPHS</code>.</li>
<li><code>graph_end</code> (5) – indicates the <a href="#rdf-statements-and-graphs">end of a graph</a> (named or default). It MUST NOT appear in streams of type other than <code>PHYSICAL_STREAM_TYPE_GRAPHS</code>.</li>
<li><code>namespace</code> (6) – <a href="#namespace-declarations">namespace declaration</a>. It may appear in any stream type.</li>
<li><code>name</code> (9) – entry in the <a href="#prefix-name-and-datatype-lookup-entries">name lookup</a>.</li>
<li><code>prefix</code> (10) – entry in the <a href="#prefix-name-and-datatype-lookup-entries">prefix lookup</a>.</li>
<li><code>datatype</code> (11) – entry in the <a href="#prefix-name-and-datatype-lookup-entries">datatype lookup</a>.</li>
</ul>
<p>Stream rows MUST be processed strictly in order to preserve the semantics of the stream.</p>
<h3 id="physical-stream-types">Physical stream types</h3>
<p>The physical type of the stream MUST be explicitly specified in the <a href="#stream-options">stream options header</a>. The physical type of the stream is defined by the <code>PhysicalStreamType</code> enum (<a href="../reference/#physicalstreamtype">reference</a>). The following types are defined:</p>
<ul>
<li><code>PHYSICAL_STREAM_TYPE_UNSPECIFIED</code> (0) – default value. This physical stream type MUST NOT be used. The implementations SHOULD treat this value as an error.</li>
<li><code>PHYSICAL_STREAM_TYPE_TRIPLES</code> (1) – stream of <a href="https://www.w3.org/TR/rdf11-concepts/#section-triples">RDF triple statements</a>. In this case, the stream MUST NOT contain <code>RdfStreamRow</code> messages with the <code>quad</code>, <code>graph_start</code>, or <code>graph_end</code> fields set.</li>
<li><code>PHYSICAL_STREAM_TYPE_QUADS</code> (2) – stream of RDF quad statements (same as <a href="https://www.w3.org/TR/n-quads/#simple-triples"><em>simple statements</em> in N-Quads</a>). In this case, the stream MUST NOT contain <code>RdfStreamRow</code> messages with the <code>triple</code>, <code>graph_start</code>, or <code>graph_end</code> fields set.</li>
<li><code>PHYSICAL_STREAM_TYPE_GRAPHS</code> (3) – stream of RDF graphs (named or default). In this case, the stream MUST NOT contain <code>RdfStreamRow</code> messages with the <code>quad</code> fields set.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See also <a href="../../user-guide/#stream-types">a more human explanation</a> of the available physical stream types.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The physical stream type only specifies how the data is encoded, not how it should be interpreted. See the <a href="#logical-stream-types">logical stream types</a> for a mechanism to specify the semantics of the stream.</p>
</div>
<h3 id="logical-stream-types">Logical stream types</h3>
<p>Specifying the logical stream type in the <a href="#stream-options">stream options header</a> is OPTIONAL. When it is specified, the implementations MAY use it to determine the semantics of the stream. The implementations also MAY ignore the specified logical stream type and interpret the stream in any other manner. The logical stream type is defined by the <code>LogicalStreamType</code> enum (<a href="../reference/#logicalstreamtype">reference</a>).</p>
<p>This version of Jelly uses the <a href="https://w3id.org/stax/1.1.2/">RDF Stream Taxonomy (RDF-STaX) 1.1.2</a> and implements all stream types of RDF-STaX as logical stream types. The following logical stream types are defined:</p>
<ul>
<li><code>LOGICAL_STREAM_TYPE_UNSPECIFIED</code> (0) – default value. This logical stream type is used when the serializer chooses not to specify the logical stream type.</li>
<li><code>LOGICAL_STREAM_TYPE_FLAT_TRIPLES</code> (1)<ul>
<li>RDF-STaX name: Flat RDF triple stream</li>
<li>RDF-STaX IRI: <a href="https://w3id.org/stax/1.1.2/ontology#flatTripleStream"><code>https://w3id.org/stax/ontology#flatTripleStream</code></a></li>
</ul>
</li>
<li><code>LOGICAL_STREAM_TYPE_FLAT_QUADS</code> (2)<ul>
<li>RDF-STaX name: Flat RDF quad stream</li>
<li>RDF-STaX IRI: <a href="https://w3id.org/stax/1.1.2/ontology#flatQuadStream"><code>https://w3id.org/stax/ontology#flatQuadStream</code></a></li>
</ul>
</li>
<li><code>LOGICAL_STREAM_TYPE_GRAPHS</code> (3)<ul>
<li>RDF-STaX name: RDF graph stream</li>
<li>RDF-STaX IRI: <a href="https://w3id.org/stax/1.1.2/ontology#graphStream"><code>https://w3id.org/stax/ontology#graphStream</code></a></li>
</ul>
</li>
<li><code>LOGICAL_STREAM_TYPE_DATASETS</code> (4)<ul>
<li>RDF-STaX name: RDF dataset stream</li>
<li>RDF-STaX IRI: <a href="https://w3id.org/stax/1.1.2/ontology#datasetStream"><code>https://w3id.org/stax/ontology#datasetStream</code></a></li>
</ul>
</li>
<li><code>LOGICAL_STREAM_TYPE_SUBJECT_GRAPHS</code> (13)<ul>
<li>RDF-STaX name: RDF subject graph stream</li>
<li>RDF-STaX IRI: <a href="https://w3id.org/stax/1.1.2/ontology#subjectGraphStream"><code>https://w3id.org/stax/ontology#subjectGraphStream</code></a></li>
<li>Subtype of: <code>LOGICAL_STREAM_TYPE_GRAPHS</code> (3)</li>
</ul>
</li>
<li><code>LOGICAL_STREAM_TYPE_NAMED_GRAPHS</code> (14)<ul>
<li>RDF-STaX name: RDF named graph stream</li>
<li>RDF-STaX IRI: <a href="https://w3id.org/stax/1.1.2/ontology#namedGraphStream"><code>https://w3id.org/stax/ontology#namedGraphStream</code></a></li>
<li>Subtype of: <code>LOGICAL_STREAM_TYPE_DATASETS</code> (4)</li>
</ul>
</li>
<li><code>LOGICAL_STREAM_TYPE_TIMESTAMPED_NAMED_GRAPHS</code> (114)<ul>
<li>RDF-STaX name: Timestamped RDF named graph stream</li>
<li>RDF-STaX IRI: <a href="https://w3id.org/stax/1.1.2/ontology#timestampedNamedGraphStream"><code>https://w3id.org/stax/ontology#timestampedNamedGraphStream</code></a></li>
<li>Subtype of: <code>LOGICAL_STREAM_TYPE_NAMED_GRAPHS</code> (14)</li>
</ul>
</li>
</ul>
<h4 id="version-compatibility-and-base-types">Version compatibility and base types</h4>
<p>In all Jelly versions 1.x.y there MUST be the same four base logical stream types (numbered 1, 2, 3, 4). The remaining logical stream types (with numbers greater than 10) may change between releases in the 1.x.y family, following the <a href="#versioning">versioning rules</a>. The four base types (1–4) are thus fixed, enabling forward compatibility for implementations that only support the base types.</p>
<p>Each remaining logical stream type is a subtype of a base type (including recursive subtyping). To determine the base type of a logical stream type, the implementation MUST take the last digit of the logical stream type number, which is equivalent to the modulo 10 operation. Implementations MAY choose to treat a subtype of a base type in the same manner as the base type itself.</p>
<details class="example">
<summary>Example (click to expand)</summary>
<p>The base type of <code>LOGICAL_STREAM_TYPE_NAMED_GRAPHS</code> (14) is <code>LOGICAL_STREAM_TYPE_DATASETS</code> (4).</p>
<p>The base type of <code>LOGICAL_STREAM_TYPE_TIMESTAMPED_NAMED_GRAPHS</code> (114) is <code>LOGICAL_STREAM_TYPE_DATASETS</code> (4).</p>
<p>The base type of <code>LOGICAL_STREAM_TYPE_FLAT_TRIPLES</code> (1) is <code>LOGICAL_STREAM_TYPE_FLAT_TRIPLES</code> (1).</p>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In practice, the base logical stream types (1–4) are the most important part, determining how the data should be shaped and processed. The other logical stream types are used to provide additional information about the stream. If you are implementing a streaming serializer/deserializer, you should focus on the base types and treat their subtypes in the same way. So, do a modulo 10 on the stream type and you are good to go.</p>
</div>
<h4 id="consistency-with-physical-stream-types">Consistency with physical stream types</h4>
<p>Implementations MAY choose to use the logical stream type to determine how to interpret the stream. In that case, the implementation SHOULD ensure that the logical stream type is consistent with the physical stream type in the sense that the implementation supports this combination of stream types. If the logical stream type is inconsistent with the physical stream type, the implementation MAY throw an error.</p>
<p>The following table shows the RECOMMENDED support matrix for the logical stream types and physical stream types, along with the RECOMMENDED manner in which the stream should be interpreted:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">RDF-STaX (logical type) / Physical type</th>
<th style="text-align: center;"><code>TRIPLES</code></th>
<th style="text-align: center;"><code>QUADS</code></th>
<th style="text-align: center;"><code>GRAPHS</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>LOGICAL_STREAM_TYPE_GRAPHS</code></td>
<td style="text-align: center;">Framed</td>
<td style="text-align: center;">✘</td>
<td style="text-align: center;">✘</td>
</tr>
<tr>
<td style="text-align: left;"><code>LOGICAL_STREAM_TYPE_SUBJECT_GRAPHS</code></td>
<td style="text-align: center;">Framed</td>
<td style="text-align: center;">✘</td>
<td style="text-align: center;">✘</td>
</tr>
<tr>
<td style="text-align: left;"><code>LOGICAL_STREAM_TYPE_DATASETS</code></td>
<td style="text-align: center;">✘</td>
<td style="text-align: center;">Framed</td>
<td style="text-align: center;">Framed</td>
</tr>
<tr>
<td style="text-align: left;"><code>LOGICAL_STREAM_TYPE_NAMED_GRAPHS</code></td>
<td style="text-align: center;">✘</td>
<td style="text-align: center;">Framed</td>
<td style="text-align: center;">Framed</td>
</tr>
<tr>
<td style="text-align: left;"><code>LOGICAL_STREAM_TYPE_TIMESTAMPED_NAMED_GRAPHS</code></td>
<td style="text-align: center;">✘</td>
<td style="text-align: center;">Framed</td>
<td style="text-align: center;">Framed</td>
</tr>
<tr>
<td style="text-align: left;"><code>LOGICAL_STREAM_TYPE_FLAT_TRIPLES</code></td>
<td style="text-align: center;">Continuous</td>
<td style="text-align: center;">✘</td>
<td style="text-align: center;">✘</td>
</tr>
<tr>
<td style="text-align: left;"><code>LOGICAL_STREAM_TYPE_FLAT_QUADS</code></td>
<td style="text-align: center;">✘</td>
<td style="text-align: center;">Continuous</td>
<td style="text-align: center;">Continuous</td>
</tr>
</tbody>
</table>
<p>In the table above, the following interpretations are used:</p>
<ul>
<li><strong>Framed</strong> – each stream frame SHOULD be interpreted as a stream element, as per RDF-STaX definition.</li>
<li><strong>Continuous</strong> – the stream SHOULD be interpreted as a continuous flat stream of elements, as per RDF-STaX definition. In this case, the stream frames carry no meaning.</li>
<li><strong>✘</strong> – the combination of the logical stream type and the physical stream type is not directly supported.</li>
</ul>
<p>The implementations MAY choose to interpret the stream in a different manner than the one specified in the table.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the <a href="../../user-guide/#stream-types">user's guide</a> for a more intuitive explanation of what this means.</p>
<p>In any case, you can choose to entirely ignore this table which should only be treated as a recommended starting point. For example, you could have an RDF graph stream with physical type <code>GRAPHS</code>, where each graph spans multiple stream frames. This and other non-standard combinations are completely fine, just make sure that all actors involved support it.</p>
</div>
<h3 id="stream-options">Stream options</h3>
<p>The stream options is a message of type <code>RdfStreamOptions</code> (<a href="../reference/#rdfstreamoptions">reference</a>). It MUST be the first row in the stream. It MAY appear more than once in the stream (also after other rows), but it MUST be identical to all previous occurrences. Implementations MAY throw an error if the stream options header is not present at the start of the stream, alternatively, they MAY use the default options. Implementations SHOULD NOT throw an error if the stream options header is present more than once in the stream.</p>
<p>The stream options header instructs the consumer of the stream (parser) on the size of the needed lookups to decode the stream and the features used by the stream.</p>
<p>The stream options header contains the following fields:</p>
<ul>
<li><code>stream_name</code> (1) – name of the stream. This field is OPTIONAL and the manner in which it should be used is not defined by this specification. It MAY be used to identify the stream.</li>
<li><code>physical_type</code> (2) – <a href="#physical-stream-types">physical type of the stream</a>. This field is REQUIRED.</li>
<li><code>generalized_statements</code> (3) – whether the stream contains <a href="https://www.w3.org/TR/rdf11-concepts/#section-generalized-rdf">generalized RDF triples or graphs</a>. This field MUST be set to true if the stream contains generalized RDF triples or graphs. It SHOULD NOT be set to true if the stream does not use this feature. This field is OPTIONAL and defaults to false.</li>
<li><code>rdf_star</code> (4) – whether the stream uses <a href="https://w3c.github.io/rdf-star/cg-spec/editors_draft.html">RDF-star</a> (quoted triples). This field MUST be set to true if the stream uses RDF-star. It SHOULD NOT be set to true if the stream does not use this feature. This field is OPTIONAL and defaults to false.</li>
<li><code>max_name_table_size</code> (9) – maximum size of the <a href="#prefix-name-and-datatype-lookup-entries">name lookup</a>. This field is OPTIONAL and defaults to 0 (no lookup). If the field is set to 0, the name lookup MUST NOT be used in the stream. If the field is set to a positive value, the name lookup SHOULD be used in the stream and the size of the lookup MUST NOT exceed the value of this field.</li>
<li><code>max_prefix_table_size</code> (10) – maximum size of the <a href="#prefix-name-and-datatype-lookup-entries">prefix lookup</a>. This field is OPTIONAL and defaults to 0 (no lookup). If the field is set to 0, the prefix lookup MUST NOT be used in the stream. If the field is set to a positive value, the prefix lookup SHOULD be used in the stream and the size of the lookup MUST NOT exceed the value of this field.</li>
<li><code>max_datatype_table_size</code> (11) – maximum size of the <a href="#prefix-name-and-datatype-lookup-entries">datatype lookup</a>. This field is OPTIONAL and defaults to 0 (no lookup). If the field is set to 0, the datatype lookup MUST NOT be used in the stream (which effectively prohibits the use of <a href="#literals">datatype literals</a>). If the field is set to a positive value, the datatype lookup SHOULD be used in the stream and the size of the lookup MUST NOT exceed the value of this field.</li>
<li><code>logical_type</code> (14) – <a href="#logical-stream-types">logical type of the stream</a>, based on RDF-STaX. This field is OPTIONAL and defaults to <code>LOGICAL_STREAM_TYPE_UNSPECIFIED</code>.</li>
<li><code>version</code> (15) – <a href="#versioning">version tag</a> of the stream. This field is REQUIRED.<ul>
<li>The version tag is encoded as a varint. The version tag MUST be greater than 0.</li>
<li>The producer of the stream MUST set the version tag to the version tag of the protocol that was used to serialize the stream.</li>
<li>It is RECOMMENDED that the producer uses the lowest possible version tag that is compatible with the features used in the stream.</li>
<li>The consumer SHOULD throw an error if the version tag is greater than the version tag of the implementation.</li>
<li>The consumer SHOULD throw an error if the version tag is zero.</li>
<li>The consumer SHOULD NOT throw an error if the version tag is not zero but lower than the version tag of the implementation.</li>
<li>The producer may use version tags greater than 10000 to indicate non-standard versions of the protocol.</li>
</ul>
</li>
</ul>
<h3 id="prefix-name-and-datatype-lookup-entries">Prefix, name, and datatype lookup entries</h3>
<p>Jelly uses a common mechanism of lookup tables for IRI prefixes, IRI names (postfixes), and datatypes. The lookups are used to compress the IRIs and datatypes in the stream. All lookups share the same base mechanism:</p>
<ul>
<li>The lookup is a map from a varint to a valid UTF-8 string.</li>
<li>The lookup can be modified at any point in the stream. The modification consists of setting the lookup for a given varint to a given string. The modification MUST be applied to all subsequent rows in the stream.</li>
<li>The first use of a given lookup element MUST be after it is defined in the lookup. If the consumer encounters a lookup element that is not defined in the lookup, it SHOULD throw an error.</li>
<li>The lookups are indexed from <code>1</code>. The default value of <code>0</code> is a special value:<ul>
<li>If the index is set to <code>0</code> in the first entry of the lookup in the stream, it MUST be interpreted as the value <code>1</code>.</li>
<li>If the index is set to <code>0</code> in any other lookup entry, it MUST be interpreted as <code>previous_index + 1</code>, that is, the index of the previous entry incremented by one.</li>
</ul>
</li>
<li>The maximum size of the lookup is communicated at the start of the stream (see <a href="#stream-options">stream options header</a>). The producer of the stream MUST NOT exceed the maximum size of the lookup. The consumer of the stream MAY implement the lookup as a fixed-size array, or extend it dynamically.</li>
<li>The lookup is updated with different messages, depending on the type of the lookup:<ul>
<li><a href="../reference/#rdfnameentry"><code>RdfNameEntry</code></a> for the name lookup,</li>
<li><a href="../reference/#rdfprefixentry"><code>RdfPrefixEntry</code></a> for the prefix lookup,</li>
<li><a href="../reference/#rdfdatatypeentry"><code>RdfDatatypeEntry</code></a> for the datatype lookup.</li>
</ul>
</li>
<li>The producer may use any strategy to update the lookup.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The spec does not specify what strategy should the producer use to update the lookup. You can use a the LRU strategy (as used in the Java/Scala implementation), LFU, or something more complex. You can also have a fixed lookup in the producer and communicate it at the start of the stream. This is possible if you are using a fixed set of prefixes, names, or datatypes and want to conserve computing power (e.g., in IoT devices).</p>
<p>The simplest way to implement the consumer's lookup is to just use an indexed array of fixed size. The workload on the consumer's side is much lower than on the producer's side, so your choice of the strategy depends largely on the producer.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value of <code>0</code> has a special meaning in lookup entries. You should take advantage of that and use it whenever possible. As the value of <code>0</code> is encoded with exactly zero bytes, you can save some space by using it.</p>
</div>
<h3 id="rdf-statements-and-graphs">RDF statements and graphs</h3>
<p>RDF statements (triples or quads) are communicated in three different ways, depending on the type of the stream:</p>
<ul>
<li><code>PHYSICAL_STREAM_TYPE_TRIPLES</code> – triples are encoded using <a href="../reference/#rdftriple"><code>RdfTriple</code></a> messages.<ul>
<li><code>RdfTriple</code> consists of three oneofs: <code>subject</code>, <code>predicate</code>, <code>object</code>, corresponding to the three terms in an RDF triple. Each of these oneofs has four fields, out of which at most one MUST be set.</li>
<li>If no field in a given oneof is set, the term is considered to be a repeated term (see <a href="#repeated-terms">repeated terms</a>).</li>
</ul>
</li>
<li><code>PHYSICAL_STREAM_TYPE_QUADS</code> – quads are encoded using <a href="../reference/#rdfquad"><code>RdfQuad</code></a> messages.<ul>
<li><code>RdfQuad</code> consists of four oneofs: <code>subject</code>, <code>predicate</code>, <code>object</code>, <code>graph</code>, corresponding to the three terms and one graph node of the quad. Each of these oneofs has four fields, out of which at most one MUST be set.</li>
<li>If no field in a given oneof is set, the term is considered to be a repeated term/graph node (see <a href="#repeated-terms">repeated terms</a>).</li>
</ul>
</li>
<li><code>PHYSICAL_STREAM_TYPE_GRAPHS</code> – graphs are encoded using <a href="../reference/#rdfgraphstart"><code>RdfGraphStart</code></a> and <a href="../reference/#rdfgraphend"><code>RdfGraphEnd</code></a> messages. Triples between the start and end of the graph are encoded using <a href="../reference/#rdftriple"><code>RdfTriple</code></a> messages. If a triple is between the start and end of the graph, it is considered to be in the graph.<ul>
<li>In this type of stream, triples MUST NOT occur outside of a graph. If a triple is encountered outside a graph, the consumer SHOULD throw an error.</li>
<li>A graph start MUST NOT occur inside another graph. If a graph start is encountered inside another graph, the consumer SHOULD throw an error.</li>
<li>A graph end MUST NOT occur outside a graph. If a graph end is encountered outside a graph, the consumer MAY throw an error.</li>
<li>A graph MAY be empty (i.e., it may contain no triples).</li>
<li>A graph corresponding to one graph node MAY occur multiple times in a stream or a stream frame. The consumer MUST treat all occurrences of the graph as a single RDF graph.</li>
<li>A graph MAY span more than one stream frame. The consumer MUST treat the graph spanning several stream frames as a single RDF graph.</li>
<li>Exactly one field in the <code>RdfGraphStart</code> message MUST be set – no repeated terms are allowed here. The consumer SHOULD throw an error if no field in the <code>graph</code> oneof is set.</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the stream is meant to represent a single RDF dataset, then the graphs should be able to stretch across several stream frames. If the stream is meant to represent a stream of RDF datasets, then the graphs should be contained within a single stream frame.</p>
</div>
<h4 id="repeated-terms">Repeated terms</h4>
<p>Both <code>RdfTriple</code> and <code>RdfQuad</code> offer a simple compression mechanism – repeated terms. If a term in a given position (subject, predicate, object, or graph node in quads) is not set, then it is interpreted to be the same as the term in the same position in the previous triple or quad. Repeated terms are encoded simply by not setting any field in the corresponding oneof, and therefore take up zero bytes in the stream.</p>
<ul>
<li>Repeated terms MUST NOT occur in quoted triples.</li>
<li>Repeated terms MUST NOT occur in the first statement row of the stream.</li>
<li>Repeated terms MAY occur in the first statement row of a stream frame. In this case, the repeated terms MUST be interpreted as repeated from the previous stream frame.</li>
<li>A repeated term in a given position MAY occur after a repeated term. The consumer MUST interpret all consecutive appearances of the repeated term as the same term.</li>
</ul>
<details class="example">
<summary>Example (click to expand)</summary>
<p>In the example the wrapping <code>RdfStreamRow</code>s were omitted for brevity:</p>
<div class="language-protobuf highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="err">#</span><span class="w"> </span><span class="n">First</span><span class="w"> </span><span class="n">row</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">RdfTriple</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="n">s_iri</span><span class="o">:</span><span class="w"> </span><span class="n">RdfIri</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">        </span><span class="n">prefix_id</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">        </span><span class="n">name_id</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span><span class="n">p_iri</span><span class="o">:</span><span class="w"> </span><span class="n">RdfIri</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">        </span><span class="n">prefix_id</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">        </span><span class="n">name_id</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">    </span><span class="n">o_bnode</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;b1&quot;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="p">}</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="err">#</span><span class="w"> </span><span class="n">Second</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="err">–</span><span class="w"> </span><span class="n">repeating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">subject</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">predicate</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="err">#</span><span class="w"> </span><span class="n">s_iri</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">p_iri</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">reused</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">row</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">RdfTriple</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">    </span><span class="n">o_bnode</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;b2&quot;</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="p">}</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="err">#</span><span class="w"> </span><span class="n">Third</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="err">–</span><span class="w"> </span><span class="n">repeating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">subject</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">object</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="err">#</span><span class="w"> </span><span class="n">s_iri</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">o_bnode</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">reused</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">row</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">RdfTriple</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="w">    </span><span class="n">p_iri</span><span class="o">:</span><span class="w"> </span><span class="n">RdfIri</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="w">        </span><span class="n">prefix_id</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="w">        </span><span class="n">name_id</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="p">}</span>
</span></code></pre></div>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Repeated terms are a simple, yet incredibly effective compression mechanism and you should use them whenever possible. They are doubly effective: not only you save space by not repeating the terms, but also repeated terms are not encoded at all (zero bytes on the wire), which saves even more space.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Repeated terms can be simply implemented with four variables (s, p, o, g) holding the last non-repeated value of a term in that position. This O(1) solution is what the Scala implementation uses.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although repeated terms can stretch across stream frame boundaries (i.e., refer to values last seen in the previous stream frame), you don't have to use this feature. If your use case requires the stream frames to be more independent of each other (see: <a href="#ordering">stream frame ordering</a>), you can just reset the repeated terms at the start of each stream frame.</p>
</div>
<h3 id="rdf-terms-and-graph-nodes">RDF terms and graph nodes</h3>
<p>RDF terms and graph nodes are encoded using oneofs in <a href="../reference/#rdftriple"><code>RdfTriple</code></a>, <a href="../reference/#rdfquad"><code>RdfQuad</code></a>, and <a href="../reference/#rdfgraphstart"><code>RdfGraphStart</code></a>. The oneofs have each several fields, depending on the type of the term: <code>*_iri</code>, <code>*_bnode</code>, <code>*_literal</code>, <code>*_triple_term</code>, <code>g_default_graph</code>, corresponding to RDF IRIs, blank nodes, literals, RDF-star quoted triples, and the default RDF graph in an RDF dataset, respectively. At most one field in each oneof MUST be set.</p>
<h4 id="iris">IRIs</h4>
<p>The IRIs are encoded using the <a href="../reference/#rdfiri"><code>RdfIri</code></a> message. The message has two fields that together make up the IRI:</p>
<ul>
<li><code>prefix_id</code> (1) – 1-based index of the prefix of the IRI, corresponding to an entry in the prefix lookup.<ul>
<li>The default value of <code>0</code> MUST be interpreted as the same value as in the last explictly specified (non-zero) prefix identifier.</li>
<li>If <code>0</code> appears in the first IRI of the stream (and in any subsequent IRI), this MUST be interpreted as an empty prefix (zero-length string). This is for example used when the prefix lookup table is set to size zero.</li>
</ul>
</li>
<li><code>name_id</code> (2) – 1-based index of the name (suffix) of the IRI, corresponding to an entry in the name lookup. This field is OPTIONAL and the default value (0) indicates an empty name.<ul>
<li>The default value of <code>0</code> MUST be interpreted as <code>previous_name_id + 1</code>, that is, the <code>name_id</code> of the previous IRI incremented by one.</li>
<li>If <code>0</code> appears in the first IRI of the stream it MUST be interpreted as <code>1</code>.</li>
<li>Multiple <code>0</code> values in a row may occur, in which case the <code>name_id</code> MUST be interpreted as incrementing by one for each <code>0</code> value.</li>
</ul>
</li>
</ul>
<p>For the default value behavior to work correctly, IRIs in the stream MUST be processed strictly in order: firstly by stream row, then by term (subject, predicate, object, graph). This also applies recursively to RDF-star quoted triples and to <a href="#namespace-declarations">namespace declarations</a>.</p>
<p>The IRI is then constructed by first decoding the prefix and the name using the <a href="#prefix-name-and-datatype-lookup-entries">prefix and name lookup tables</a>, and then concatenating the prefix and the name. The IRI SHOULD be a valid IRI, as defined in <a href="https://tools.ietf.org/html/rfc3987">RFC 3987</a>.</p>
<details class="example">
<summary>Example with the prefix table (click to expand)</summary>
<p>Assume the following lookup entries were defined in the stream (wrapping <code>RdfStreamRow</code>s were omitted for brevity):</p>
<div class="language-protobuf highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">RdfPrefixEntry</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="n">prefix</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;http://example.com/&quot;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="p">}</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">RdfNameEntry</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">    </span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="p">}</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="n">RdfNameEntry</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">    </span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="p">}</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="n">RdfNameEntry</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">    </span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;test&quot;</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="p">}</span>
</span></code></pre></div>
<p>Then the following IRIs are encoded as follows:</p>
<div class="language-protobuf highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="err">#</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//example.com/example</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">RdfIri</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">    </span><span class="n">prefix_id</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="n">name_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="p">}</span><span class="w"> </span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="err">#</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//example.com/</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="n">RdfIri</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">    </span><span class="n">prefix_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">    </span><span class="n">name_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="p">}</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="err">#</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//test.com/test</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="n">RdfIri</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="w">    </span><span class="n">prefix_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="w">    </span><span class="n">name_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="p">}</span>
</span></code></pre></div>
<p>Note that the default values (zeroes) are not encoded at all in Protobuf and therefore take up zero bytes in the stream.</p>
</details>
<details class="example">
<summary>Example without the prefix table (click to expand)</summary>
<p>In this example, the prefix lookup table is not used. The lookup entries are defined as follows:</p>
<div class="language-protobuf highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">RdfNameEntry</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;http://example.com/example&quot;</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="p">}</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">RdfNameEntry</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">    </span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;http://example.com/test&quot;</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="p">}</span>
</span></code></pre></div>
<p>Then the following IRIs are encoded as follows:</p>
<div class="language-protobuf highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="err">#</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//example.com/example</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">RdfIri</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="n">prefix_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">prefix</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span><span class="n">name_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="p">}</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="err">#</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//example.com/test</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="n">RdfIri</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">    </span><span class="n">prefix_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">prefix</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">    </span><span class="n">name_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="p">}</span>
</span></code></pre></div>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The spec does not specify how to split the IRIs into names and prefixes. You can use any strategy you want, as long as you follow the rules above. The simplest way is to split the IRI at the last occurrence of the <code>#</code> or <code>/</code> character – this is what the Scala implementation uses. </p>
<p><strong>These prefixes are not meant to be user-facing</strong>, they can be entirely arbitrary and DO NOT correspond to, for example <code>@prefix</code> declarations in Turtle. If you want to preserve such user-facing namespace declarations, use the <a href="#namespace-declarations"><code>RdfNamespaceDeclaration</code></a> feature instead.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The behavior of the default values is designed to save space in the stream. Usually in RDF many IRIs share the same prefix, so you can save space by not repeating the prefix in the stream. At the same time the name part of the IRI is often unique, so for each name you will need a new entry in the lookup table – which is often the next entry after the one you have just created.</p>
</div>
<h4 id="blank-nodes">Blank nodes</h4>
<p>RDF blank nodes are represented using simple strings. The string is the identifier of the blank node. The identifier MUST be a valid UTF-8 string.</p>
<p>Because the spec does not define the semantics of the stream frames, blank node identifiers are not guaranteed to be unique across multiple stream frames. The consumer MAY choose to treat the blank nodes as unique across the stream (and thus treat all occurences of the identifier as a single node), or it MAY choose to treat them as unique only within a single stream frame. The consumer MAY use the <a href="#logical-stream-types">logical stream type</a> to determine how to treat the blank nodes. The producer SHOULD specify in the documentation which strategy it uses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the stream is meant to represent a single RDF graph or dataset (flat RDF stream in RDF-STaX), then the blank node identifiers should be unique across the stream so that you can refer to them across stream frame boundaries. If the frames refer to different graphs or datasets (grouped RDF stream in RDF-STaX), then the blank node identifiers should be unique only within a single frame.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Many RDF libraries (e.g., RDF4J, Apache Jena) use internal identifiers for blank nodes, which can be used as the identifiers in Jelly streams. You can also use a different format, for example with shorter identifiers to preserve space.</p>
</div>
<h4 id="literals">Literals</h4>
<p>RDF literals are represented using the <code>RdfLiteral</code> message (<a href="../reference/#rdfliteral">reference</a>). The message has the following fields:</p>
<ul>
<li><code>lex</code> (1) – the lexical form of the literal in UTF-8. This field is OPTIONAL and defaults to an empty string.</li>
<li><code>literalKind</code> oneof. At most one of the following fields MUST be set:<ul>
<li><code>langtag</code> (2) – UTF-8 language tag, indicating that the literal is a language-tagged string (has datatype IRI equal to <code>http://www.w3.org/1999/02/22-rdf-syntax-ns#langString</code>). The language tag SHOULD be a valid <a href="https://tools.ietf.org/html/bcp47">BCP 47</a> language tag.</li>
<li><code>datatype</code> (3) – 1-based index of the datatype in the <a href="#prefix-name-and-datatype-lookup-entries">datatype lookup</a>, indicating that the literal is a typed literal. The value of this field MUST be greater than 0 and it MUST correspond to a valid entry in the datatype lookup.</li>
</ul>
</li>
</ul>
<p>If no field in the <code>literalKind</code> oneof is set, then the literal MUST be interpreted as a simple literal (has datatype IRI equal to <code>http://www.w3.org/2001/XMLSchema#string</code>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using the default value of <code>0</code> for the <code>datatype</code> field is not allowed, in contrast to names and prefixes in RdfIri. This is because the <code>datatype</code> field itself is optional and the default value would be ambiguous.</p>
</div>
<h4 id="quoted-triples-rdf-star">Quoted triples (RDF-star)</h4>
<p>RDF-star quoted triples are represented using the <code>RdfTriple</code> message (<a href="../reference/#rdftriple">reference</a>). Quoted triples are encoded in the same manner as triple statements, with the only difference being that <a href="#repeated-terms">repeated terms</a> MUST NOT be used in quoted triples. The consumer SHOULD throw an error if a repeated term is encountered in a quoted triple.</p>
<p>Quoted triples may be nested up to arbitrary depth. The consumer SHOULD throw an error if the depth of the nesting exceeds the capabilities of the implementation.</p>
<h4 id="graph-nodes">Graph nodes</h4>
<p>Literal, IRI, and blank node values for graph nodes are encoded in the same manner as for the subject, predicate, and object terms.</p>
<p>The default graph node is represented using the <code>RdfDefaultGraph</code> message (<a href="../reference/#rdfdefaultgraph">reference</a>). The message is empty and has no fields. The default graph node indicates that the triple is part of the default graph.</p>
<h2 id="namespace-declarations">Namespace declarations</h2>
<p>IRI namespace declarations are not a part of the RDF Abstract Syntax. They are a convenience / cosmetic feature of the serialization format to allow preserving associations between short namespace names and full IRIs. Namespace declarations are encoded using the <code>RdfNamespaceDeclaration</code> message (<a href="../reference/#rdfnamespacedeclaration">reference</a>). The message has the following fields:</p>
<ul>
<li><code>name</code> (1) – the short name of the namespace, encoded in UTF-8. It SHOULD conform to the <a href="https://www.w3.org/TR/2014/REC-turtle-20140225/#grammar-production-PN_PREFIX"><code>PN_PREFIX</code> production in RDF 1.1 Turtle</a>. Note that the <code>:</code> character (colon) is not part of the name. An empty string (the default value) is allowed.</li>
<li><code>value</code> (2) – the IRI of the namespace as an <code>RdfIri</code> message. This field is REQUIRED.</li>
</ul>
<p>Namespace declarations have no effect on the interpretation of the stream in terms of the RDF Abstract Syntax. Therefore, they MUST NOT be used to, for example, shorten IRIs in the stream. The namespace declarations are purely cosmetic and are meant to be used only to preserve human-readable prefixes between the producer and the consumer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To clarify: <code>RdfIri</code> messages in namespace declarations are treated EXACTLY in the same way as terms in triples or quads. That means that the default value of <code>0</code> has the exact same meaning. You can freely intersperse namespace declarations with triples or quads. For example, if you first have a namespace declaration with <code>prefix_id</code> set to <code>5</code>, then the next <code>RdfIri</code> message in a triple with <code>prefix_id</code> set to <code>0</code> will be interpreted as the same prefix (<code>5</code>) as in the namespace declaration.</p>
</div>
<details class="example">
<summary>Example (click to expand)</summary>
<p>To encode the Turtle namespace declaration <code>@prefix ex: &lt;http://example.com/&gt; .</code> you would use the following messages (the wrapping <code>RdfStreamRow</code>s were omitted for brevity):</p>
<div class="language-protobuf highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">RdfPrefixEntry</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="n">value</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;http://example.com/&quot;</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="p">}</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="err">#</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">define</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">entry</span><span class="p">,</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="k">required</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="n">RdfNameEntry</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">    </span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">    </span><span class="n">value</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="p">}</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="n">RdfNamespaceDeclaration</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;ex&quot;</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">    </span><span class="n">value</span><span class="o">:</span><span class="w"> </span><span class="n">RdfIri</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">        </span><span class="n">prefix_id</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">        </span><span class="n">name_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="p">}</span>
</span></code></pre></div>
<p>Alternatively, if not using the prefix lookup table:</p>
<div class="language-protobuf highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">RdfNameEntry</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="n">value</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;http://example.com/&quot;</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="p">}</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="n">RdfNamespaceDeclaration</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;ex&quot;</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">    </span><span class="n">value</span><span class="o">:</span><span class="w"> </span><span class="n">RdfIri</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">        </span><span class="n">prefix_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">prefix</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">        </span><span class="n">name_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">interpreted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="p">}</span>
</span></code></pre></div>
</details>
<h2 id="delimited-variant-of-jelly">Delimited variant of Jelly</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, Protobuf messages <a href="https://protobuf.dev/programming-guides/techniques/#streaming">are not delimited</a>, so if you write multiple messages to the same file / socket / byte stream, you need to add some kind of delimiter between them. Jelly uses the convention already implemented in some protobuf libraries of prepending a varint before the message, to specify the length of the message. </p>
</div>
<p>A byte stream (or file) in the delimited variant MUST consist of a series of delimited <code>RdfStreamFrame</code> messages. A delimited message is a message that has a varint prepended before it, specifying the length of the message in bytes.</p>
<p>Implementing the delimited variant is OPTIONAL.</p>
<h3 id="delimited-variant-implementations">Delimited variant implementations</h3>
<p>The delimiting convention is implemented in Protobuf libraries for:</p>
<ul>
<li>C++: <a href="https://github.com/protocolbuffers/protobuf/blob/main/src/google/protobuf/util/delimited_message_util.cc">delimited_message_util.cc</a></li>
<li>Java / Scala: <a href="https://developers.google.com/protocol-buffers/docs/reference/java/com/google/protobuf/MessageLite#writeDelimitedTo-java.io.OutputStream-">writeDelimitedTo</a> and <a href="https://developers.google.com/protocol-buffers/docs/reference/java/com/google/protobuf/Parser#parseDelimitedFrom-java.io.InputStream-">parseDelimitedFrom</a></li>
</ul>
<p>The JVM (Scala) implementation of Jelly also supports the delimited variant – <a href="https://w3id.org/jelly/jelly-jvm/dev/user/reactive#byte-streams-delimited-variant">see the documentation</a>.</p>
<h2 id="internet-media-type-and-file-extension">Internet media type and file extension</h2>
<p>The RECOMMENDED media type for Jelly is <code>application/x-jelly-rdf</code>. The RECOMMENDED file extension is <code>.jelly</code>.</p>
<p>The files SHOULD be saved in the <a href="#delimited-variant-of-jelly">delimited variant of Jelly</a>.</p>
<h2 id="security-considerations">Security considerations</h2>
<p><em>This section is not part of the specification.</em></p>
<h3 id="protocol-buffers">Protocol Buffers</h3>
<p>The Jelly serialization format is based on Protocol Buffers, which handles all binary manipulation, and therefore is most likely to be the main security concern. Please refer to the <a href="https://protobuf.dev/support/version-support/">Protobuf Version Support page</a> for information on security patches and support. See also the published <a href="https://www.cve.org/CVERecord/SearchResults?query=Protocol+Buffers">CVE Records for Protocol Buffers</a>.</p>
<h3 id="overly-large-lookup-tables">Overly large lookup tables</h3>
<p>For untrusted input, consumers must always validate that the requested size of a prefix, name, or datatype lookup table is not overly large and supported by the consumer. A malicious producer could attempt to exhaust the memory of the consumer by requesting a lookup table of several gigabytes or more. This would constitute a denial-of-service vector.</p>
<p>The recommended mitigation is for each implementation to define a maximum allowed lookup size and check if the requested size is within the limit. If the requested size exceeds the limit, the consumer should throw an error and reject the stream.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The Jelly-JVM implementation uses a configurable limit (up to 4096 entries by default). The mechanism is described <a href="https://w3id.org/jelly/jelly-jvm/dev/user/utilities/#jelly-options-presets">here</a>.</p>
<p>The Jelly gRPC streaming protocol has a built-in mechanism for stream options handling that does include such checks. See the <a href="../streaming/#stream-options-handling">gRPC streaming protocol specification</a>.</p>
</div>
<h3 id="invalid-lookup-entry-ids-and-references">Invalid lookup entry IDs and references</h3>
<p>For untrusted input, consumers must always validate that the lookup entry IDs in the stream are valid and within the bounds of the lookup table. A malicious producer could attempt to reference a non-existent entry in the lookup table, which could lead to it reading or writing arbitrary memory.</p>
<p>This is automatically handled by languages that include array bounds checking, such as Java or Python. In languages without array bounds checking, the consumer must manually check that the lookup entry ID is within the bounds of the lookup table.</p>
<h3 id="infinite-recursion-of-rdf-star-quoted-triples">Infinite recursion of RDF-star quoted triples</h3>
<p>A malicious producer may attempt to create a stream with RDF-star quoted triples that are nested to an arbitrary depth. This could lead to a stack overflow in the consumer, which could be used as a denial-of-service vector.</p>
<p>The official Protobuf implementations are not vulnerable to this type of attack, as they include a message recursion limit (100 by default). Implementations should verify that their Protobuf library supports this limit and that it is set to a reasonable value.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>In practice, there are very few (if any) use cases where very deep recursive nesting would be needed for Jelly. Unless you are working with some very exotic data, you should be fine with setting the recursion limit to as low as 10 messages. But still, even the default limit of 100 should not cause you any problems, unless operating under extremely constrained environments.</p>
<p>Streams without RDF-star require only 4 nesting levels. Each nested RDF-star quoted triple adds one level of nesting.</p>
</div>
<h3 id="rdf-content">RDF content</h3>
<p>Jelly is a general serialization format for RDF data, and as such, may be used to transmit malicious or misleading content, such as links to phishing websites or false information. Please refer to the <a href="https://www.w3.org/TR/turtle/#sec-mediaReg">RDF 1.1 Turtle W3C Recommendation</a> for information on security considerations related to RDF content.</p>
<h3 id="encryption-authentication-and-authorization">Encryption, authentication, and authorization</h3>
<p>Jelly does not provide any built-in mechanisms for encryption, authentication, or authorization, as it only handles data serialization. If you need to secure your data, you should use a secure transport layer (e.g., HTTPS) and implement encryption, authentication, and authorization on the application level.</p>
<h2 id="implementations">Implementations</h2>
<p><em>This section is not part of the specification.</em></p>
<p>The following implementations of the Jelly serialization format specification are available:</p>
<ul>
<li><a href="https://w3id.org/jelly/jelly-jvm/dev/">Jelly-JVM (Scala) implementation</a><ul>
<li>Specification version: dev</li>
<li>Implemented actors: producer, consumer</li>
<li>Conformance: full</li>
<li>Supported RDF libraries: <a href="https://jena.apache.org/">Apache Jena</a>, <a href="https://rdf4j.org/">RDF4J</a></li>
</ul>
</li>
</ul>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">March 26, 2025</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 4, 2023</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
        <a href="https://creativecommons.org/licenses/by/4.0/">
        <span style="font-size: 1.1em;">
        <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="m245.83 214.87-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93-22.13 0-33.22 14.61-33.22 43.84 0 23.57 9.21 43.84 33.22 43.84 14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98-22.6 0-73.96-10.32-73.96-77.05 0-58.69 43-77.06 72.63-77.06 30.72-.01 52.7 11.95 65.99 35.86zm143.05 0-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93-22.14 0-33.22 14.61-33.22 43.84 0 23.55 9.23 43.84 33.22 43.84 14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98-22.69 0-73.96-9.87-73.96-77.05 0-58.67 42.97-77.06 72.63-77.06 30.71-.01 52.58 11.95 65.56 35.86zM247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248 129.93 0 248.44-100.87 248.44-248 0-137.87-106.62-248-248.44-248zm.87 450.81c-112.54 0-203.7-93.04-203.7-202.81 0-105.42 85.43-203.27 203.72-203.27 112.53 0 202.82 89.46 202.82 203.26-.01 121.69-99.68 202.82-202.84 202.82z"></path></svg></span> <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M314.9 194.4v101.4h-28.3v120.5h-77.1V295.9h-28.3V194.4c0-4.4 1.6-8.2 4.6-11.3 3.1-3.1 6.9-4.7 11.3-4.7H299c4.1 0 7.8 1.6 11.1 4.7 3.1 3.2 4.8 6.9 4.8 11.3zm-101.5-63.7c0-23.3 11.5-35 34.5-35s34.5 11.7 34.5 35c0 23-11.5 34.5-34.5 34.5s-34.5-11.5-34.5-34.5zM247.6 8C389.4 8 496 118.1 496 256c0 147.1-118.5 248-248.4 248C113.6 504 0 394.5 0 256 0 123.1 104.7 8 247.6 8zm.8 44.7C130.2 52.7 44.7 150.6 44.7 256c0 109.8 91.2 202.8 203.7 202.8 103.2 0 202.8-81.1 202.8-202.8.1-113.8-90.2-203.3-202.8-203.3z"></path></svg></span>
        </span>Creative Commons Attribution 4.0</a><br />Jelly's documentation is licensed under CC BY 4.0. The code is licensed under Apache 2.0. See also: <strong><a href="/latest/licensing">licensing</a></strong>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/Jelly-RDF" target="_blank" rel="noopener" title="Jelly on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://discord.gg/A8sN5XwVa5" target="_blank" rel="noopener" title="Community Discord server" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.top", "navigation.indexes", "toc.follow", "search.suggest", "search.highlight", "content.code.copy", "content.action.edit"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>